head(mturk_subset)
qualtrics <- fread('../data/qualtrics_results_final.csv')
# colnames(qualtrics)
qualtrics_subset <-
qualtrics[, c(
"StartDate",
"EndDate",
"Status" ,
"IPAddress" ,
"Progress",
"Duration (in seconds)",
"Finished",
"RecordedDate",
"ResponseId",
"Q80",
"Random ID",
"FL_6_DO"
)]
nrow(qualtrics)
# get rid of results from pilot
qualtrics_subset <- qualtrics_subset[63:.N,]
nrow(qualtrics_subset)
setnames(qualtrics_subset,'Q80','WorkerId')
setnames(qualtrics_subset,'Random ID', 'RandomID')
qualtrics_subset[,duration_min := as.numeric(`Duration (in seconds)`)/60]
head(qualtrics_subset)
qualtrics[Finished == F, ]
qualtrics_subset
qualtrics_subset[, .N]
qualtrics_subset
qualtrics_subset[Finished = "F"]
qualtrics_subset[Finished = "False"]
qualtrics_subset
qualtrics_subset[Finished == "False"]
qualtrics_subset[Progress == "99"]
qualtrics_subset[Progress == "99", .N]
qualtrics_subset[, Progress := as.numeric(Progress)]
qualtrics_subset[Progress <= 35, .N]
#Attrition before Treatment 2
qualtrics_subset[Progress %in% c(36:68)
qualtrics_subset[Progress %in% c(36:68), .N]
qualtrics_subset[(Progress <= 68) & (Progress > 35), .N] -
qualtrics_subset[Progress <= 68, .N] - qualtrics_subset[Progress <= 35, .N]
qualtrics_subset[Progress <= 68, .N]
qualtrics_subset[Progress <= 35, .N]
qualtrics_subset[Progress <= 35, .N]
qualtrics_subset[Progress <= 35, .N]
qualtrics_subset[Progress <= 68, .N]
qualtrics_subset
View(qualtrics_subset)
qualtrics_subset[Progress <= 98, .N]
qualtrics_subset[Progress <= 98, .N] - 14
qualtrics_subset[Progress == "99", .N]
qualtrics_subset[Progress <= 35, .N]
qualtrics_subset[Progress <= 68, .N]
qualtrics_subset[Progress <= 98, .N]
qualtrics_subset[Progress <= 98, .N]
qualtrics_subset[Progress <= 98, .N] - qualtrics_subset[Progress <= 68, .N] - qualtrics_subset[Progress <= 35, .N]
qualtrics_subset[Progress <= 98, .N]
qualtrics_subset[Progress <= 68, .N]
qualtrics_subset[Progress <= 98, .N] - qualtrics_subset[Progress <= 68, .N]
qualtrics_subset[Finished == "False"]
qualtrics_subset[Finished == "False", .N]
d_respondents_only <-
d_respondents_only[!ResponseId %in% c(
'R_1eRkKqfVAmkVzj2',
'R_3FR03xu5zyOsRSU',
'R_3HBQsMSMCgXPpKf',
'R_dbzictBknL9jG3T'
) & Finished == "False", .N]
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(data.table)
library(knitr)
library(cobalt)
library(stargazer)
library(sandwich)
library(car)
library(dplyr)
library(ggmap)
library(revgeo)
library(AER)
library(ggplot2)
library(expss)
library(grid)
library(gridExtra)
library(pander)
# clears workspace
rm(list = ls())
# round all numbers to 4 decimals
options(digits=4)
# set theme for ggplot to be cleaner
theme_set(theme_light())
# d <- fread('Lungs_November+14,+2020_17.33.csv')
d <- fread('../check-valid-responses/data/qualtrics_results_final.csv')
d_respondents_only <-
d[(Status == "IP Address")]
d_respondents_only <-
d_respondents_only[!ResponseId %in% c(
'R_1eRkKqfVAmkVzj2',
'R_3FR03xu5zyOsRSU',
'R_3HBQsMSMCgXPpKf',
'R_dbzictBknL9jG3T'
) & Finished == "False", .N]
d_respondents_only
# d <- fread('Lungs_November+14,+2020_17.33.csv')
d <- fread('../check-valid-responses/data/qualtrics_results_final.csv')
d_respondents_only <-
d[(Status == "IP Address")]
d_respondents_only[!ResponseId %in% c(
'R_1eRkKqfVAmkVzj2',
'R_3FR03xu5zyOsRSU',
'R_3HBQsMSMCgXPpKf',
'R_dbzictBknL9jG3T'
) & Finished == "False", .N]
d_respondents_only[!ResponseId %in% c(
'R_1eRkKqfVAmkVzj2',
'R_3FR03xu5zyOsRSU',
'R_3HBQsMSMCgXPpKf',
'R_dbzictBknL9jG3T'
) & Finished == "False", .N]
d_respondents_only[!ResponseId %in% c(
'R_1eRkKqfVAmkVzj2',
'R_3FR03xu5zyOsRSU',
'R_3HBQsMSMCgXPpKf',
'R_dbzictBknL9jG3T'
) & Finished == "False", .N]
d_respondents_only[ResponseId %in% c(
'R_1eRkKqfVAmkVzj2',
'R_3FR03xu5zyOsRSU',
'R_3HBQsMSMCgXPpKf',
'R_dbzictBknL9jG3T'
) & Finished == "False", .N]
d_respondents_only[Q80 %in% c(
"A119EX2L0DNN1B",
"A12NQJV6TA5OWB",
"A18WFPSLFV4FKY",
"A1BUYK6LXYWMLL",
"A1FHRZXSE7XNJ4",
"A1GMYDH5MKN105",
"A2GSZ3D2XXC533",
"A2IGIOD74EPOEF",
"A2J016DRTOBXWO",
"A2NGFU82LMJ80X",
"A32K1M0A36EAK5",
"A371SNJNNUY9Z6",
"A3BPENSX5EVJ2H",
"A3EPIT2P3ISA3K",
"A3NYIJYBHAJ74V",
"AUFLTHQAXWLH1",
"AVINXZZV3FNG7" ,
"A1CD7O60QAQQRT",
"A1CF1W8CP0DHB0",
"A1PGY59BR6C5BX",
"A1YSYI926BBOHW",
"A1Z3GFH6MNSU46",
"A211KGJ94WNFLN",
"A26RPQDD0RQEHL",
"A2BUHMLNE3LUU0",
"A2J5BRQ88W745H",
"A2XIHO2W7EEP32",
"A3EZ0H07TSDAPW",
"A3FLBC6LC5GJ3W",
"A3QLKLIQW1B1FR",
"A8F6JFG0WSELT",
"A9K6IVBA0J1CX",
"ADLZLGHKOAEE6",
"AE7NJG0KOVZYJ" ,
"AG5RF4UGQJ7A7" ,
"AQ9Y6WD8O72ZC" ,
"tuturtu"
) & Finished == "False", .N]
d_respondents_only[Q80 %in% c(
'A1W05TSPORJPXR'
,'A3SUWCLD1GEGM7'
,'A3A09JB9X1RBXW'
,'A7VQQEIBSM9IU'
,'A8DER1QY96C5X'
,'A1M8MNKK8H5ZGW'
,'A34D5D6PU193AR'
) & Finished == "False", .N]
?xlab
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 45)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(data.table)
library(knitr)
library(cobalt)
library(stargazer)
library(sandwich)
library(car)
library(dplyr)
library(ggmap)
library(revgeo)
library(AER)
library(ggplot2)
library(expss)
library(grid)
library(gridExtra)
library(pander)
d_respondents <- fread('datatable_clean_survey_responses_v2.dta')
d_respondents[ , US_Dummy := ifelse(country == "United States", 1, 0)]
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 45)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Gender) +
xlab('Assignment Group') +
ylab('Gender') +
labs(title = 'Contingency table between gender and assignment group',
caption = paste0('Assuming gender distributions are the same among assignment groups, a chi-squared test for independence with ',
round(gender_chiqq$parameter,4),' \ndegrees of freedom ', 'yields p=',
round(gender_chiqq$p.value,4),
', suggesting that there is no relationship between gender and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between age ranges
age_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Age_Range)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Age_Range) +
xlab('Assignment Group') +
ylab('Age') +
labs(title = 'Contingency table between age range and assignment group',
caption = paste0('Assuming age distributions are the same among assignment groups, a chi-squared test for independence with Monte \nCarlo simulation yields p=',
round(age_chisq$p.value,4),
', suggesting that there is no relationship between age and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
#check balance between education levels
edu_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Education_Level)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Education_Level) +
xlab('Assignment Group') +
ylab('Education Level') + las ('Education Level')
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 45)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Gender) +
xlab('Assignment Group') +
ylab('Gender') +
labs(title = 'Contingency table between gender and assignment group',
caption = paste0('Assuming gender distributions are the same among assignment groups, a chi-squared test for independence with ',
round(gender_chiqq$parameter,4),' \ndegrees of freedom ', 'yields p=',
round(gender_chiqq$p.value,4),
', suggesting that there is no relationship between gender and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between age ranges
age_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Age_Range)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Age_Range) +
xlab('Assignment Group') +
ylab('Age') +
labs(title = 'Contingency table between age range and assignment group',
caption = paste0('Assuming age distributions are the same among assignment groups, a chi-squared test for independence with Monte \nCarlo simulation yields p=',
round(age_chisq$p.value,4),
', suggesting that there is no relationship between age and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
#check balance between education levels
edu_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Education_Level)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Education_Level) +
xlab('Assignment Group') +
ylab('Education Level') +
labs(title = 'Contingency table between education and assignment group',
caption = paste0('Assuming education distributions are the same among assignment groups, a chi-squared test for \nindependence with Monte Carlo simulation yields p=',
round(edu_chisq$p.value,4),
', suggesting that there is no relationship \nbetween education and assignment groups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between US and non-US respondents
us_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, US_Dummy)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$US_Dummy) +
xlab('Assignment Group') +
ylab('Country') +
scale_y_discrete(breaks=c("0", "1"),
labels=c("Non-US", "United States")) +
labs(title = 'Contingency table between country and assignment group',
caption = paste0('Assuming country distributions are the same among assignment groups, a chi-squared test for independence with \n',
round(us_chisq$parameter,4),' degrees of freedom ', 'yields p=',
round(us_chisq$p.value,4),
', suggesting that there is no relationship between country and assignment \ngroups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Gender) +
xlab('Assignment Group') +
ylab('Gender') +
labs(title = 'Contingency table between gender and assignment group',
caption = paste0('Assuming gender distributions are the same among assignment groups, a chi-squared test for independence with ',
round(gender_chiqq$parameter,4),' \ndegrees of freedom ', 'yields p=',
round(gender_chiqq$p.value,4),
', suggesting that there is no relationship between gender and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between age ranges
age_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Age_Range)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Age_Range) +
xlab('Assignment Group') +
ylab('Age') +
labs(title = 'Contingency table between age range and assignment group',
caption = paste0('Assuming age distributions are the same among assignment groups, a chi-squared test for independence with Monte \nCarlo simulation yields p=',
round(age_chisq$p.value,4),
', suggesting that there is no relationship between age and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
#check balance between education levels
edu_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Education_Level)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Education_Level) +
xlab('Assignment Group') +
ylab('Education Level') +
labs(title = 'Contingency table between education and assignment group',
caption = paste0('Assuming education distributions are the same among assignment groups, a chi-squared test for \nindependence with Monte Carlo simulation yields p=',
round(edu_chisq$p.value,4),
', suggesting that there is no relationship \nbetween education and assignment groups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between US and non-US respondents
us_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, US_Dummy)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$US_Dummy) +
xlab('Assignment Group') +
ylab('Country') +
scale_y_discrete(breaks=c("0", "1"),
labels=c("Non-US", "United States")) +
labs(title = 'Contingency table between country and assignment group',
caption = paste0('Assuming country distributions are the same among assignment groups, a chi-squared test for independence with \n',
round(us_chisq$parameter,4),' degrees of freedom ', 'yields p=',
round(us_chisq$p.value,4),
', suggesting that there is no relationship between country and assignment \ngroups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 77)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Gender) +
xlab('Assignment Group') +
ylab('Gender') +
labs(title = 'Contingency table between gender and assignment group',
caption = paste0('Assuming gender distributions are the same among assignment groups, a chi-squared test for independence with ',
round(gender_chiqq$parameter,4),' \ndegrees of freedom ', 'yields p=',
round(gender_chiqq$p.value,4),
', suggesting that there is no relationship between gender and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between age ranges
age_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Age_Range)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Age_Range) +
xlab('Assignment Group') +
ylab('Age') +
labs(title = 'Contingency table between age range and assignment group',
caption = paste0('Assuming age distributions are the same among assignment groups, a chi-squared test for independence with Monte \nCarlo simulation yields p=',
round(age_chisq$p.value,4),
', suggesting that there is no relationship between age and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
#check balance between education levels
edu_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Education_Level)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Education_Level) +
xlab('Assignment Group') +
ylab('Education Level') +
labs(title = 'Contingency table between education and assignment group',
caption = paste0('Assuming education distributions are the same among assignment groups, a chi-squared test for \nindependence with Monte Carlo simulation yields p=',
round(edu_chisq$p.value,4),
', suggesting that there is no relationship \nbetween education and assignment groups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between US and non-US respondents
us_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, US_Dummy)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$US_Dummy) +
xlab('Assignment Group') +
ylab('Country') +
scale_y_discrete(breaks=c("0", "1"),
labels=c("Non-US", "United States")) +
labs(title = 'Contingency table between country and assignment group',
caption = paste0('Assuming country distributions are the same among assignment groups, a chi-squared test for independence with \n',
round(us_chisq$parameter,4),' degrees of freedom ', 'yields p=',
round(us_chisq$p.value,4),
', suggesting that there is no relationship between country and assignment \ngroups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 88)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Gender) +
xlab('Assignment Group') +
ylab('Gender') +
labs(title = 'Contingency table between gender and assignment group',
caption = paste0('Assuming gender distributions are the same among assignment groups, a chi-squared test for independence with ',
round(gender_chiqq$parameter,4),' \ndegrees of freedom ', 'yields p=',
round(gender_chiqq$p.value,4),
', suggesting that there is no relationship between gender and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between age ranges
age_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Age_Range)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Age_Range) +
xlab('Assignment Group') +
ylab('Age') +
labs(title = 'Contingency table between age range and assignment group',
caption = paste0('Assuming age distributions are the same among assignment groups, a chi-squared test for independence with Monte \nCarlo simulation yields p=',
round(age_chisq$p.value,4),
', suggesting that there is no relationship between age and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
#check balance between education levels
edu_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Education_Level)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Education_Level) +
xlab('Assignment Group') +
ylab('Education Level') +
labs(title = 'Contingency table between education and assignment group',
caption = paste0('Assuming education distributions are the same among assignment groups, a chi-squared test for \nindependence with Monte Carlo simulation yields p=',
round(edu_chisq$p.value,4),
', suggesting that there is no relationship \nbetween education and assignment groups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between US and non-US respondents
us_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, US_Dummy)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$US_Dummy) +
xlab('Assignment Group') +
ylab('Country') +
scale_y_discrete(breaks=c("0", "1"),
labels=c("Non-US", "United States")) +
labs(title = 'Contingency table between country and assignment group',
caption = paste0('Assuming country distributions are the same among assignment groups, a chi-squared test for independence with \n',
round(us_chisq$parameter,4),' degrees of freedom ', 'yields p=',
round(us_chisq$p.value,4),
', suggesting that there is no relationship between country and assignment \ngroups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
create_heatmap <- function(var1, var2) {
### Create a heatmap for a table of frequencies between two variables ###
df <- data.frame(table(var1,var2))
ggplot(df,aes(x=var1,y=var2)) +
geom_tile(aes(fill=Freq,color=Freq),show.legend=FALSE,alpha=.8) +
geom_text(aes(label=Freq)) +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_continuous(high = "darkslategray4", low = "powderblue")
}
# check balance between genders
gender_chiqq <- chisq.test(d_respondents[ , table(Assignment_Group, Gender)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Gender) +
xlab('Assignment Group') +
ylab('Gender') +
labs(title = 'Contingency table between gender and assignment group',
caption = paste0('Assuming gender distributions are the same among assignment groups, a chi-squared test for independence with ',
round(gender_chiqq$parameter,4),' \ndegrees of freedom ', 'yields p=',
round(gender_chiqq$p.value,4),
', suggesting that there is no relationship between gender and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between age ranges
age_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Age_Range)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Age_Range) +
xlab('Assignment Group') +
ylab('Age') +
labs(title = 'Contingency table between age range and assignment group',
caption = paste0('Assuming age distributions are the same among assignment groups, a chi-squared test for independence with Monte \nCarlo simulation yields p=',
round(age_chisq$p.value,4),
', suggesting that there is no relationship between age and assignment groups at a \nsignificance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
#check balance between education levels
edu_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, Education_Level)],simulate.p.value = TRUE)
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$Education_Level) +
xlab('Assignment Group') +
ylab('Education Level') +
labs(title = 'Contingency table between education and assignment group',
caption = paste0('Assuming education distributions are the same among assignment groups, a chi-squared test for \nindependence with Monte Carlo simulation yields p=',
round(edu_chisq$p.value,4),
', suggesting that there is no relationship \nbetween education and assignment groups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
# check balance between US and non-US respondents
us_chisq <- chisq.test(d_respondents[ , table(Assignment_Group, US_Dummy)])
create_heatmap(var1 = d_respondents$Assignment_Group,var2 = d_respondents$US_Dummy) +
xlab('Assignment Group') +
ylab('Country') +
scale_y_discrete(breaks=c("0", "1"),
labels=c("Non-US", "United States")) +
labs(title = 'Contingency table between country and assignment group',
caption = paste0('Assuming country distributions are the same among assignment groups, a chi-squared test for independence with \n',
round(us_chisq$parameter,4),' degrees of freedom ', 'yields p=',
round(us_chisq$p.value,4),
', suggesting that there is no relationship between country and assignment \ngroups at a significance level of 0.05.')) +
theme(plot.caption = element_text(hjust = 0))
